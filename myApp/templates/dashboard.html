{% extends 'base_internal.html' %}
{% load static %}

{% block title %}Dashboard - KaTek AI{% endblock %}

{% block page_title %}Dashboard{% endblock %}

{% block content %}
<div class="space-y-8">
  <!-- Header -->
  <div>
    <h1 class="text-3xl font-bold text-white mb-2">Welcome back, {{ user.first_name|default:user.username }}!</h1>
    <p class="text-gray-300 text-lg">Here's what's happening with your AI agent today</p>
  </div>
  
  <!-- Metrics Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
    <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-6 text-center hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group">
      <div class="w-12 h-12 bg-gradient-to-br from-violet-600 to-violet-500 rounded-lg flex items-center justify-center mx-auto mb-4 group-hover:scale-105 transition-transform duration-200">
        <i class="fas fa-users text-white text-lg"></i>
      </div>
      <div class="text-3xl font-bold text-violet-400 mb-1">24</div>
      <div class="text-gray-300 text-sm font-medium mb-1">Leads Today</div>
      <div class="text-emerald-400 text-xs font-medium">+12% from yesterday</div>
    </div>
    
    <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-6 text-center hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group">
      <div class="w-12 h-12 bg-gradient-to-br from-violet-600 to-violet-500 rounded-lg flex items-center justify-center mx-auto mb-4 group-hover:scale-105 transition-transform duration-200">
        <i class="fas fa-comments text-white text-lg"></i>
      </div>
      <div class="text-3xl font-bold text-violet-400 mb-1">8</div>
      <div class="text-gray-300 text-sm font-medium mb-1">Active Conversations</div>
      <div class="text-emerald-400 text-xs font-medium">+3 this hour</div>
    </div>
    
    <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-6 text-center hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group">
      <div class="w-12 h-12 bg-gradient-to-br from-violet-600 to-violet-500 rounded-lg flex items-center justify-center mx-auto mb-4 group-hover:scale-105 transition-transform duration-200">
        <i class="fas fa-home text-white text-lg"></i>
      </div>
      <div class="text-3xl font-bold text-violet-400 mb-1">$2.4M</div>
      <div class="text-gray-300 text-sm font-medium mb-1">Inventory Value</div>
      <div class="text-emerald-400 text-xs font-medium">+$180K this week</div>
    </div>
    
    <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-6 text-center hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group">
      <div class="w-12 h-12 bg-gradient-to-br from-violet-600 to-violet-500 rounded-lg flex items-center justify-center mx-auto mb-4 group-hover:scale-105 transition-transform duration-200">
        <i class="fas fa-chart-line text-white text-lg"></i>
      </div>
      <div class="text-3xl font-bold text-violet-400 mb-1">87%</div>
      <div class="text-gray-300 text-sm font-medium mb-1">Conversion Rate</div>
      <div class="text-emerald-400 text-xs font-medium">+5% this month</div>
    </div>
  </div>
  
  <!-- Main Content Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Chart Section -->
    <div class="lg:col-span-2">
      <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-6 shadow-xl">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-bold text-white">Leads Over Time</h3>
          <div class="flex gap-2">
            <button class="px-3 py-1 bg-violet-600 text-white text-xs rounded-lg font-medium">7 Days</button>
            <button class="px-3 py-1 bg-white/10 border border-white/20 text-gray-300 text-xs rounded-lg font-medium hover:bg-white/20 transition-all duration-200">30 Days</button>
            <button class="px-3 py-1 bg-white/10 border border-white/20 text-gray-300 text-xs rounded-lg font-medium hover:bg-white/20 transition-all duration-200">90 Days</button>
          </div>
        </div>
        <div class="h-80 bg-gradient-to-br from-white/5 to-white/10 rounded-lg flex items-center justify-center">
          <div class="text-center text-gray-400">
            <i class="fas fa-chart-area text-4xl mb-4"></i>
            <p class="text-lg">Chart visualization will appear here</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Sidebar -->
    <div class="space-y-6">
      <!-- Recent Conversations -->
      <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-6 shadow-xl">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-lg font-bold text-white">Recent Conversations</h3>
          <a href="#" class="text-violet-400 text-sm font-medium hover:text-violet-300 transition-colors duration-200">View All</a>
        </div>
        
        <div class="space-y-3">
          <div class="flex items-center gap-3 p-3 rounded-lg hover:bg-white/10 transition-all duration-200 cursor-pointer">
            <div class="w-10 h-10 bg-violet-600 rounded-full flex items-center justify-center text-white font-bold text-sm">S</div>
            <div class="flex-1 min-w-0">
              <p class="text-white text-sm font-medium">Sarah Johnson</p>
              <p class="text-gray-400 text-xs truncate">Looking for a 3BR condo in downtown...</p>
            </div>
            <div class="text-gray-400 text-xs">2m ago</div>
          </div>
          
          <div class="flex items-center gap-3 p-3 rounded-lg hover:bg-white/10 transition-all duration-200 cursor-pointer">
            <div class="w-10 h-10 bg-violet-600 rounded-full flex items-center justify-center text-white font-bold text-sm">M</div>
            <div class="flex-1 min-w-0">
              <p class="text-white text-sm font-medium">Mike Chen</p>
              <p class="text-gray-400 text-xs truncate">Interested in the luxury penthouse...</p>
            </div>
            <div class="text-gray-400 text-xs">15m ago</div>
          </div>
          
          <div class="flex items-center gap-3 p-3 rounded-lg hover:bg-white/10 transition-all duration-200 cursor-pointer">
            <div class="w-10 h-10 bg-violet-600 rounded-full flex items-center justify-center text-white font-bold text-sm">A</div>
            <div class="flex-1 min-w-0">
              <p class="text-white text-sm font-medium">Alex Rodriguez</p>
              <p class="text-gray-400 text-xs truncate">Can you send me more details about...</p>
            </div>
            <div class="text-gray-400 text-xs">1h ago</div>
          </div>
        </div>
      </div>
      
      <!-- Quick Actions -->
      <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl p-6 shadow-xl">
        <h3 class="text-lg font-bold text-white mb-4">Quick Actions</h3>
        <div class="space-y-3">
          {% load extras %}
          {% is_feature_enabled 'property_creation' as property_creation_enabled %}
          {% if property_creation_enabled %}
            <a href="#" class="flex items-center gap-3 p-4 bg-white/5 border border-white/10 rounded-lg hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group" data-modal-target="#add-property-modal" hx-get="/modal/add-property/" hx-target="#add-property-modal" hx-trigger="click">
              <div class="w-10 h-10 bg-violet-600 rounded-lg flex items-center justify-center group-hover:scale-105 transition-transform duration-200">
                <i class="fas fa-plus text-white"></i>
              </div>
              <div>
                <h4 class="text-white text-sm font-bold">Add Property</h4>
                <p class="text-gray-400 text-xs">Upload new listing</p>
              </div>
            </a>
          {% else %}
            {% get_disabled_tooltip 'property_creation' as property_creation_tooltip %}
            <a href="#" class="flex items-center gap-3 p-4 bg-white/5 border border-white/10 rounded-lg opacity-50 cursor-not-allowed" disabled title="{{ property_creation_tooltip }}">
              <div class="w-10 h-10 bg-gray-600 rounded-lg flex items-center justify-center">
                <i class="fas fa-plus text-white"></i>
              </div>
              <div>
                <h4 class="text-gray-400 text-sm font-bold">Add Property</h4>
                <p class="text-gray-500 text-xs">Upload new listing</p>
              </div>
            </a>
          {% endif %}
          
          {% is_feature_enabled 'campaign_management' as campaign_management_enabled %}
          {% if campaign_management_enabled %}
            <a href="#" class="flex items-center gap-3 p-4 bg-white/5 border border-white/10 rounded-lg hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group">
              <div class="w-10 h-10 bg-violet-600 rounded-lg flex items-center justify-center group-hover:scale-105 transition-transform duration-200">
                <i class="fas fa-paper-plane text-white"></i>
              </div>
              <div>
                <h4 class="text-white text-sm font-bold">Send Campaign</h4>
                <p class="text-gray-400 text-xs">Email your leads</p>
              </div>
            </a>
          {% else %}
            {% get_disabled_tooltip 'campaign_management' as campaign_management_tooltip %}
            <a href="#" class="flex items-center gap-3 p-4 bg-white/5 border border-white/10 rounded-lg opacity-50 cursor-not-allowed" disabled title="{{ campaign_management_tooltip }}">
              <div class="w-10 h-10 bg-gray-600 rounded-lg flex items-center justify-center">
                <i class="fas fa-paper-plane text-white"></i>
              </div>
              <div>
                <h4 class="text-gray-400 text-sm font-bold">Send Campaign</h4>
                <p class="text-gray-500 text-xs">Email your leads</p>
              </div>
            </a>
          {% endif %}
          
          <a href="{% url 'chat_agent' %}" class="flex items-center gap-3 p-4 bg-white/5 border border-white/10 rounded-lg hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group">
            <div class="w-10 h-10 bg-violet-600 rounded-lg flex items-center justify-center group-hover:scale-105 transition-transform duration-200">
              <i class="fas fa-robot text-white"></i>
            </div>
            <div>
              <h4 class="text-white text-sm font-bold">Configure AI</h4>
              <p class="text-gray-400 text-xs">Setup your agent</p>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Recent Properties -->
  <div>
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-bold text-white">Recent Properties</h2>
      <a href="{% url 'properties' %}" class="px-4 py-2 bg-white/10 border border-white/20 text-gray-300 rounded-lg hover:bg-white/20 hover:text-white transition-all duration-200 font-medium">View All Properties</a>
    </div>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl overflow-hidden hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group">
        <div class="h-48 bg-gradient-to-br from-white/5 to-white/10 flex items-center justify-center">
          <i class="fas fa-home text-gray-400 text-4xl"></i>
        </div>
        <div class="p-4">
          <h3 class="text-lg font-bold text-white mb-2">Modern 3BR Condo</h3>
          <p class="text-gray-400 text-sm mb-2">Downtown District</p>
          <p class="text-violet-400 text-xl font-bold mb-3">$485,000</p>
          <div class="flex gap-4 text-gray-400 text-xs">
            <span><i class="fas fa-bed mr-1"></i>3 beds</span>
            <span><i class="fas fa-bath mr-1"></i>2 baths</span>
            <span><i class="fas fa-ruler mr-1"></i>1,200 sqft</span>
          </div>
        </div>
      </div>
      
      <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl overflow-hidden hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group">
        <div class="h-48 bg-gradient-to-br from-white/5 to-white/10 flex items-center justify-center">
          <i class="fas fa-home text-gray-400 text-4xl"></i>
        </div>
        <div class="p-4">
          <h3 class="text-lg font-bold text-white mb-2">Luxury Penthouse</h3>
          <p class="text-gray-400 text-sm mb-2">Uptown Heights</p>
          <p class="text-violet-400 text-xl font-bold mb-3">$1,250,000</p>
          <div class="flex gap-4 text-gray-400 text-xs">
            <span><i class="fas fa-bed mr-1"></i>4 beds</span>
            <span><i class="fas fa-bath mr-1"></i>3 baths</span>
            <span><i class="fas fa-ruler mr-1"></i>2,800 sqft</span>
          </div>
        </div>
      </div>
      
      <div class="bg-white/5 backdrop-blur-md border border-white/10 rounded-xl overflow-hidden hover:bg-white/10 hover:border-white/20 transition-all duration-200 cursor-pointer group">
        <div class="h-48 bg-gradient-to-br from-white/5 to-white/10 flex items-center justify-center">
          <i class="fas fa-home text-gray-400 text-4xl"></i>
        </div>
        <div class="p-4">
          <h3 class="text-lg font-bold text-white mb-2">Cozy Studio</h3>
          <p class="text-gray-400 text-sm mb-2">Arts District</p>
          <p class="text-violet-400 text-xl font-bold mb-3">$285,000</p>
          <div class="flex gap-4 text-gray-400 text-xs">
            <span><i class="fas fa-bed mr-1"></i>1 bed</span>
            <span><i class="fas fa-bath mr-1"></i>1 bath</span>
            <span><i class="fas fa-ruler mr-1"></i>650 sqft</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/modal.js' %}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Chart filter interactions
  const filterBtns = document.querySelectorAll('.filter-btn');
  filterBtns.forEach(btn => {
    btn.addEventListener('click', function() {
      filterBtns.forEach(b => {
        b.classList.remove('bg-violet-600', 'text-white');
        b.classList.add('bg-white/10', 'border', 'border-white/20', 'text-gray-300');
      });
      this.classList.remove('bg-white/10', 'border', 'border-white/20', 'text-gray-300');
      this.classList.add('bg-violet-600', 'text-white');
    });
  });
  
  // Metric tile interactions
  const metricTiles = document.querySelectorAll('.metric-tile');
  metricTiles.forEach(tile => {
    tile.addEventListener('click', function() {
      // Add click animation
      this.style.transform = 'scale(0.98)';
      setTimeout(() => {
        this.style.transform = '';
      }, 150);
    });
  });
});
</script>

<!-- Add Property Modal -->
<div id="add-property-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="add-property-modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="add-property-modalLabel">Add New Property</h5>
                <button type="button" class="btn-close" data-modal-close aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Content will be loaded here via HTMX -->
            </div>
        </div>
    </div>
</div>

{% endblock %}