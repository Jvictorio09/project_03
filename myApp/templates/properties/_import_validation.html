{# Validation Chat Fragment #}
<div class="validation-chat">
  <div class="mb-6">
    <h3 class="text-xl font-bold text-white mb-2">Complete Your Listing</h3>
    <p class="text-gray-400 text-sm">We need a few more details to create a complete property listing.</p>
  </div>
  
  {% if chat_history %}
    <div class="chat-history bg-white/5 border border-white/10 rounded-lg p-4 mb-4 max-h-64 overflow-y-auto space-y-3">
      {% for message in chat_history|slice:":5" %}
        <div class="flex {% if message.role == 'user' %}justify-end{% else %}justify-start{% endif %}">
          <div class="max-w-[80%] rounded-lg p-3 {% if message.role == 'user' %}bg-violet-600 text-white{% else %}bg-white/10 text-gray-300{% endif %}">
            <p class="text-sm">{{ message.content }}</p>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endif %}
  
  {% if error %}
    <div class="bg-red-500/20 border border-red-500/50 rounded-lg p-3 mb-4">
      <p class="text-red-400 text-sm">{{ error }}</p>
    </div>
  {% endif %}
  
  {% if next_question.field %}
    <div class="question-prompt bg-white/5 border border-white/10 rounded-lg p-4 mb-4">
      <p class="text-white font-semibold mb-2">{{ next_question.question }}</p>
      {% if next_question.example %}
        <p class="text-gray-400 text-sm">Example: {{ next_question.example }}</p>
      {% endif %}
    </div>
  {% endif %}
  
  <form 
    hx-post="{% url 'import_validate_submit' upload.id %}"
    hx-target="#add-property-modal .modal-body"
    hx-swap="innerHTML"
    class="space-y-4">
    {% csrf_token %}
    
    <div>
      <label for="user_message" class="block text-sm font-medium text-gray-300 mb-2">
        Your Answer
      </label>
      <textarea 
        name="user_message" 
        id="user_message"
        required
        rows="3"
        class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-violet-500 resize-none"
        placeholder="Type your answer here..."></textarea>
    </div>
    
    <div class="flex justify-end gap-3">
      <button 
        type="button"
        onclick="document.getElementById('add-property-modal').classList.add('hidden');"
        class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors text-sm">
        Cancel
      </button>
      <button 
        type="submit"
        class="px-4 py-2 bg-violet-600 hover:bg-violet-700 text-white rounded-lg transition-colors text-sm font-semibold">
        <i class="fas fa-paper-plane mr-2"></i> Submit
      </button>
    </div>
  </form>
</div>

